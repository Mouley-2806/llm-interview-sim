{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center" id="config-section">
	<div class="col-lg-8 col-xl-6">
		<div class="card">
			<div class="card-header">
				<h3 class="mb-0"><i class="fas fa-cog me-2"></i>Configure Your Interview</h3>
				<p class="text-muted mb-0 mt-2">Set up your interview parameters to get started</p>
			</div>
			<div class="card-body">
				<form id="interview-config">
					<div class="mb-4">
						<label for="job_role" class="form-label">
							<i class="fas fa-user-tie me-1"></i>Job Role
						</label>
						<input type="text" class="form-control" id="job_role" 
							   placeholder="e.g., Frontend Developer, Data Scientist, Product Manager" 
							   required>
						<div class="form-text">Enter the specific role you're preparing for</div>
					</div>
					
					<div class="mb-4">
						<label class="form-label">
							<i class="fas fa-clipboard-list me-1"></i>Interview Type
						</label>
						<div class="row g-3">
							<div class="col-md-6">
								<div class="form-check">
									<input class="form-check-input" type="radio" name="interview_type" 
										   id="technical" value="Technical" checked>
									<label class="form-check-label" for="technical">
										<i class="fas fa-code me-1"></i>Technical
									</label>
									<div class="form-text">Coding, algorithms, system design</div>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-check">
									<input class="form-check-input" type="radio" name="interview_type" 
										   id="behavioral" value="Behavioral">
									<label class="form-check-label" for="behavioral">
										<i class="fas fa-comments me-1"></i>Behavioral
									</label>
									<div class="form-text">Soft skills, past experiences</div>
								</div>
							</div>
						</div>
					</div>
					
					<div class="mb-4" id="domain-section" style="display: block;">
						<label for="domain" class="form-label">
							<i class="fas fa-tags me-1"></i>Technical Domain
						</label>
						<input type="text" class="form-control" id="domain" 
							   placeholder="e.g., React, Python, Machine Learning, AWS">
						<div class="form-text">Specify the technical focus area for your interview</div>
					</div>
					
					<div class="d-grid">
						<button type="submit" class="btn btn-primary btn-lg">
							<i class="fas fa-play me-2"></i>Start Interview
						</button>
					</div>
				</form>
			</div>
		</div>
		
		<!-- Features Card -->
		<div class="card mt-4">
			<div class="card-body">
				<h5 class="card-title"><i class="fas fa-star me-2"></i>What You'll Get</h5>
				<div class="row g-3">
					<div class="col-md-4">
						<div class="text-center">
							<i class="fas fa-question-circle fa-2x text-primary mb-2"></i>
							<h6>5 Custom Questions</h6>
							<small class="text-muted">Tailored to your role and domain</small>
						</div>
					</div>
					<div class="col-md-4">
						<div class="text-center">
							<i class="fas fa-comment-dots fa-2x text-success mb-2"></i>
							<h6>AI Feedback</h6>
							<small class="text-muted">Instant evaluation and suggestions</small>
						</div>
					</div>
					<div class="col-md-4">
						<div class="text-center">
							<i class="fas fa-chart-line fa-2x text-warning mb-2"></i>
							<h6>Progress Tracking</h6>
							<small class="text-muted">Monitor your improvement over time</small>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block scripts %}
<script>
	document.addEventListener('DOMContentLoaded', function () {
		const interviewForm = document.getElementById('interview-config');
		const domainSection = document.getElementById('domain-section');
		const technicalRadio = document.getElementById('technical');
		const behavioralRadio = document.getElementById('behavioral');

		if (technicalRadio) {
			technicalRadio.addEventListener('change', function () {
				domainSection.style.display = 'block';
			});
		}
		if (behavioralRadio) {
			behavioralRadio.addEventListener('change', function () {
				domainSection.style.display = 'none';
			});
		}

		if (interviewForm) {
			interviewForm.addEventListener('submit', function (e) {
				e.preventDefault();
				const jobRole = document.getElementById('job_role').value;
				const interviewType = document.querySelector('input[name="interview_type"]:checked').value;
				const domain = interviewType === 'Technical' ? document.getElementById('domain').value : 'N/A';

				if (!jobRole) {
					alert('Please select a job role');
					return;
				}

				fetch('/configure', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({ job_role: jobRole, interview_type: interviewType, domain: domain })
				})
					.then(response => {
						if (!response.ok) throw new Error('Network response was not ok: ' + response.status);
						return response.json();
					})
					.then(data => {
						if (data.status === 'success') {
							window.location.href = '/interview';
						} else if (data.status === 'error') {
							alert('Error: ' + data.message);
						}
					})
					.catch(error => {
						alert('An error occurred while starting the interview. Please try again. Error: ' + error.message);
					});
			});
		}
	});
</script>
{% endblock %}